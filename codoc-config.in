#! /bin/sh

usage="$0 [--exec] (--docbk-to-html1 OUTPUT INPUT)

Convert the given docbook xml file to html."

if test "x$1" = x--help ||
   test "x$1" = x ||
   test "x$1" = x-h ; then
  echo "$usage" 1>&2
  exit 1
fi

# yeah i know the *-config paradigm is deprecated,
# but i'm going to give it one more go 
# in order to support xml-conversion commands.

xsltproc="@XSLTPROC@"
catalog_files="@XML_CATALOG_FILES@"
xsltproc_args="@XSLTPROC_ARGS@"
html1_xsl="@XSL_HTML_DOCBOOK_XSL@"

envcmds=""
test "x$catalog_files" = x || {
  envcmds="env XML_CATALOG_FILES=\"$catalog_files\""
}

run_command=0

if test "x$1" = "x--exec" ; then
  run_command=1
  shift
fi

case "$1" in
  --docbk-to-html1)
    output_type=`echo "$1" | sed -e 's/--docbk-to-//'`
    eval "xsl=\"\$${output_type}_xsl\""
    output="$2"
    input="$3"
    if test "$run_command" = 0 ; then
      echo "$envcmds \"$xsltproc\" -o \"$output\" \"$xsl\" \"$input\""
    else
      eval "exec $envcmds \"$xsltproc\" -o \"$output\" \"$xsl\" \"$input\""
    fi
    ;;
  *)
    echo "$0: unrecognized option: \`$1'" 1>&2
    exit 1
    ;;
esac
